{% extends "base_site.html" %}
{% load humanize %}
{% block title %} Profile - {{ racer.username.first_name }} {{ racer.username.last_name }}{% endblock title %}

{% block stylesheets %}
  {{ block.super }}
{% endblock stylesheets %}

{% block content %}
  <div class="right_col" role="main">
    <div class="">
      <div class="page-title">
        <div class="title_left">
          <h3>{{ racer.username.first_name }} {{ racer.username.last_name }} Profile</h3>
        </div>
      </div>

      <div class="clearfix"></div>

      <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
          <div class="x_panel">
            <div class="x_title">
              <h2>APA Profile</h2>
              <ul class="nav navbar-right panel_toolbox">
                
                
              </ul>
              <div class="clearfix"></div>
            </div>
            <div class="x_content">
              <div class="col-md-3 col-sm-3 col-xs-12 profile_left">
                <div class="profile_img">
                  <div id="crop-avatar">
                    <!-- Current avatar -->
                    <img class="img-responsive avatar-view" src="{{ racer.profile_image.url }}" alt="Avatar" title="{{ racer.username.first_name }}">
                  </div>
                </div>
                <h3>{{ racer.username.first_name }} {{ racer.username.last_name }}</h3>

                <ul class="list-unstyled user_data">
                  <li><i class="flag1x {{ racer.country.flag_css }}"></i>&nbsp;{{ racer.country.name }}
                  </li>
                  {% if racer.facebook_handle %}
                  <li>
                    <i class="fa fa-facebook-square user-profile-icon"></i> <a href="{{ racer.facebook_handle }}"> Facebook</a>
                  </li>
                  {% endif %}
                  {% if racer.insta_handle %}
                  <li>
                    <i class="fa fa-instagram user-profile-icon"></i> <a href="{{ racer.insta_handle }}"> Instagram</a>
                  </li>
                  {% endif %}
                  {% if racer.twitter_handle %}
                  <li>
                    <i class="fa fa-twitter-square user-profile-icon"></i> <a href="{{ racer.twitter_handle }}"> Twitter</a>
                  </li>
                  {% endif %}
                  {% if racer.personal_site %}
                  <li class="m-top-xs">
                    <i class="fa fa-external-link user-profile-icon"></i>
                    <a href="{{ racer.personal_site }}" target="_blank">{{ racer.personal_site }}</a>
                  </li>
                  {% endif %}
                </ul>

              </div>
              <div class="col-md-9 col-sm-9 col-xs-12">
                <div class="" role="tabpanel" data-example-id="togglable-tabs" id="tabs">
                  <ul id="myTab" class="nav nav-tabs bar_tabs" role="tablist">
                    <li role="presentation" class=""><a href="#tab_content1" id="home-tab" role="tab" data-toggle="tab" aria-expanded="true">Contact Information</a>
                    </li>
                    <li role="presentation" class=""><a href="#tab_content2" role="tab" id="profile-tab" data-toggle="tab" aria-expanded="false">Gallery</a>
                    </li>
                    <li role="presentation" class="active"><a href="#tab_content3" role="tab" id="profile-tab2" data-toggle="tab" aria-expanded="false">Racing Information</a>
                    </li>
                    <li role="presentation" class=""><a href="#tab_content4" role="tab" id="profile-tab2" data-toggle="tab" aria-expanded="false">Documentation</a>
                    </li>
                  </ul>
                  <div id="myTabContent" class="tab-content">
                    <div role="tabpanel" class="tab-pane fade" id="tab_content1" aria-labelledby="home-tab">

                      <!-- start recent activity -->
                <form id="contact_form" method="post" action="{% url 'racers:profile_update' racer.id %}" data-parsley-validate class="form-horizontal form-label-left">
                {% csrf_token %}
                <div class="profile_title">
                  <div class="col-md-12">
                    <h2>Personal Details</h2>
                  </div>
                  
                </div>
                <div class="ln_solid" style="margin-top: 0;"></div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Name <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input id="id_make" name="make" type="text" disabled="disabled" required="required" class="form-control col-md-7 col-xs-12" value="{{ racer.username.first_name }} {{ racer.username.last_name }}">
                  </div>
                </div>
                
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Date of Birth <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">

                    <input type="text" id="id_build_date" name="dob" required="required" class="form-control col-md-7 col-xs-12" value="">
                  </div>
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Nationality <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_nationality" name="nationality" class="form-control col-md-7 col-xs-12">
                  </div>
                </div>
                <div class="profile_title">
                  <div class="col-md-12">
                    <h2>Contact Details</h2>
                  </div>
                  
                </div>
                <div class="ln_solid" style="margin-top: 0;"></div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">E-mail Address <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_serial_number" name="serial_number" required="required" class="form-control col-md-7 col-xs-12" disabled="disabled" value="{{ racer.username.username }}">
                  </div>
                </div>
                
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Telephone Number <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="tel" id="id_phonenumber_in" name="phonenumber_in" class="form-control col-md-7 col-xs-12">
                  </div>
                  
                </div>

                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Address <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_current_boat" name="address_1" class="form-control col-md-7 col-xs-12" {% if racer.address_line_1 %}value="{{racer.address_line_1}}"{% endif %}>
                  </div>
                  
                </div>

                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">&nbsp;
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_current_boat" name="address_2" class="form-control col-md-7 col-xs-12" {% if racer.address_line_1 %}value="{{racer.address_line_2}}"{% endif %}>
                  </div>
                  
                </div>

                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">&nbsp;
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_current_boat" name="address_3" class="form-control col-md-7 col-xs-12" {% if racer.address_line_1 %}value="{{racer.address_line_3}}"{% endif %}>
                  </div>
                  
                </div>

                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Post Code/ZIP Code <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_current_boat" name="address_4" class="form-control col-md-7 col-xs-12" {% if racer.address_line_1 %}value="{{racer.address_line_4}}"{% endif %}>
                  </div>
                  
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Home Country <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_home_country" name="home_country" class="form-control col-md-7 col-xs-12">
                  </div>
                  
                </div>
              
               <div class="profile_title">
                  <div class="col-md-12">
                    <h2>Media Presence</h2>
                  </div>
                  
                </div>
                <div class="ln_solid" style="margin-top: 0;"></div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Facebook Handle
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_facebook" name="facebook" class="form-control col-md-7 col-xs-12" {% if racer.facebook_handle %}value="{{racer.facebook_handle }}"{% endif %}>
                  </div>
                  
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Instagram Handle
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_insta" name="instagram" class="form-control col-md-7 col-xs-12" {% if racer.insta_handle %}value="{{racer.insta_handle }}"{% endif %}>
                  </div>
                  
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Twitter Handle
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_twitter" name="twitter" class="form-control col-md-7 col-xs-12" {% if racer.twitter_handle %}value="{{racer.twitter_handle }}"{% endif %}>
                  </div>
                  
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Personal Site
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_personal" name="personal" class="form-control col-md-7 col-xs-12"  {% if racer.personal_site %}value="{{racer.personal_site }}"{% endif %}>
                  </div>
                  
                </div>
                <div class="ln_solid"></div>
                <div class="form-group">
                  <div class="col-md-9 col-sm-9 col-xs-12 col-md-offset-3">
                    <button type="submit" class="btn btn-danger btn-round" id="submit_button" >Update Profile</button>
                </div>
                </div>

              </form>
                      <!-- end recent activity -->

                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content2" aria-labelledby="profile-tab">

                      <!-- gallery -->
                      <div class="row">
             {% for img in racer.profile_images.all %}
              <div class="col-md-55">
                <div class="thumbnail">
                  <div class="image view view-first">
                    <img style="width: 100%; min-height: 100px;display: block;" src="{{ img.file.url }}" alt="{{ img.title }}" />
                    <div class="mask">
                      <p>{{ img.title }}</p>
                        <div class="tools tools-bottom">
                          <a href="#"><i class="fa fa-pencil"></i></a>
                          {% if img.profile_image == False %}
                          <a href="{% url 'racers:delete_profile_image' img.id %}"><i class="fa fa-times"></i></a>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                    <div class="caption">
                      <p>{{ img.caption }}</p>
                    </div>
                </div>
              </div>
             {% endfor %}
            </div>
            <div class="row">
              <div class="well text-muted text-center" style="padding-top: 4rem; padding-bottom: 4rem;">
                <span class="glyphicon glyphicon-arrow-down" style="font-size: 4rem;"></span>
                  <h3>Drop Photos Here to Upload</h3> 
                </div>
                <button style="width:100%; margin-top: 0;" type="button" class="btn btn-danger js-upload-photos">
                  <span class="glyphicon glyphicon-cloud-upload"></span> Upload photos
                </button>
                <form id="add-photos" action="{% url 'racers:upload_profile_image' racer.id %}" enctype="multipart/form-data">
                  
                <input id="id_boat_image" type="file" name="boat_image" multiple style="display: none;" data-url="" data-form-data='{"csrfmiddlewaretoken": "{{ csrf_token }}"}' enctype="multipart/form-data">
                </form>
                
            </div>

                    </div>
                    <div role="tabpanel" class="tab-pane fade active in" id="tab_content3" aria-labelledby="profile-tab">
                      <div class="profile_title">
                  <div class="col-md-12">
                    <h2>Racing Profile</h2>
                  </div>
                  
                </div>
                      <form id="contact_form" method="post" action="{% url 'racers:profile_text' racer.id %}" data-parsley-validate class="form-horizontal form-label-left">
                {% csrf_token %}
                <div class="form-group">
                  <textarea id="message" required="required" class="form-control" name="profile_text" data-parsley-trigger="keyup" data-parsley-minlength="100" data-parsley-maxlength="10000" data-parsley-minlength-message="Profile must be least a 100 characters long..."data-parsley-validation-threshold="10"  onkeyup="textAreaAdjust(this)" style="overflow:hidden">
                  </textarea>
                </div>
                <div class="form-group">
                  <div class="col-md-12 col-sm-12 col-xs-12" align="center">
                    <button type="submit" class="btn btn-danger btn-round" id="submit_button" >Update Profile</button>
                </div>
                </div>
              </form>
              <p>&nbsp;</p>
              <div class="profile_title">
                  <div class="col-md-12">
                    <h2>Career Profile</h2>
                  </div>
                  
                </div>
<table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                <thead>
                  <tr>
                    <th>Event</th>
                    <th>Country</th>
                    <th>Year</th>
                    <th>Team</th>
                    <th>Position</th>
                  </tr>
                </thead>


                <tbody>
                  {% for vic in victories %}
                  <tr>
                    <td align="center">{{ vic.name }}</td>
                    <td align="center"><i class="flag1x {{ vic.location.flag_css }}"></i>&nbsp;{{ vic.location.name }}</td>
                    <td align="center">{{ vic.year }}</td>
                    <td align="center">{{ vic.team }}</td>
                    <td align="center"><i class="fa fa-trophy"></i> {{ vic.position|ordinal }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
              <div class="profile_title">
                  <div class="col-md-12">
                    <h4>Update Career Profile</h4>
                  </div>
                  
                </div>
                <div class="ln_solid" style="margin-top: 0;"></div>
              <form id="contact_form" method="post" action="{% url 'racers:add_victory' racer.id %}" data-parsley-validate class="form-horizontal form-label-left">
                {% csrf_token %}
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Event Name <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_event" name="event" class="form-control col-md-7 col-xs-12">
                  </div>
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Team<span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_event" name="team" class="form-control col-md-7 col-xs-12">
                  </div>
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Location <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_event_location" name="event_location" class="form-control col-md-7 col-xs-12">
                  </div>
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Year <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="text" id="id_event" name="year" class="form-control col-md-7 col-xs-12">
                  </div>
                </div>
                <div class="form-group">
                  <label class="control-label col-md-3 col-sm-3 col-xs-12" for="first-name">Position <span class="required">*</span>
                  </label>
                  <div class="col-md-6 col-sm-6 col-xs-12">
                    <input type="number" id="id_event" name="position" class="form-control col-md-7 col-xs-12">
                  </div>
                </div>
                <div class="form-group">
                  <div class="col-md-12 col-sm-12 col-xs-12" align="center">
                    <button type="submit" class="btn btn-danger btn-round" id="submit_button" >Add Event</button>
                </div>
                </div>
              </form>

                    </div>
                <div role="tabpanel" class="tab-pane fade" id="tab_content4" aria-labelledby="docs-tab">
                  <div class="profile_title" style="margin-bottom: 1em;">
                  <div class="col-md-12">
                    <h2>Racing Licenses</h2>
                  </div>
                  </div>
                  <form id="license_form" method="post" action="{% url 'racers:add_license' racer.id %}" data-parsley-validate class="form-horizontal form-label-left"  enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-group">
                  <label class="control-label col-md-2 col-sm-2 col-xs-12" for="first-name">License
                  </label>
                  <div class="col-md-2 col-sm-2 col-xs-12">
                    <input type="text" id="id_licensetype" name="licensetype" class="form-control col-md-7 col-xs-12">
                  </div>
                  <label class="control-label col-md-1 col-sm-1 col-xs-12" for="first-name">Expiry</label>
                  <div class="col-md-3 col-sm-3 col-xs-12">
                    <input type="text" id="id_licenseexpiry" name="expiry_date" class="form-control col-md-7 col-xs-12">
                  </div>
                  <div class="col-md-1 col-sm-1 col-xs-12">
                    <button id="btn_id" style="" type="button" class="btn btn-danger btn-round">
                      <span class="glyphicon glyphicon-cloud-upload"></span> Upload Scan
                    </button>                 
                  <input id="id_license" type="file" name="license" multiple data-url="" data-form-data='{"csrfmiddlewaretoken": "{{ csrf_token }}"}' enctype="multipart/form-data" style="display: none;">
                  </div>
                </div>

              </form>
              <div class="ln_solid"></div>
                  <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                <thead>
                  <tr>
                    <th>License Type</th>
                    <th>Expiry Date</th>
                    <th>Expires In</th>
                    <th>Download</th>
                  </tr>
                </thead>


                <tbody>
                  {% for lic in racer_licenses %}
                  <tr>
                    <td align="center">{{ lic.license_type.name }}</td>
                    <td align="center">{{ lic.expires|date:"d/m/Y" }}</td>
                    <td align="center">{{ lic.expiry_dt|naturaltime}}</td>
                    <td align="center"><a href="{{ lic.file.url }}" target="_blank"><i class="fa fa-cloud-download"></i> Download</a></td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
                
                <div class="ln_solid" style="margin-top: 0;"></div>

                <div class="profile_title">
                  <div class="col-md-12">
                    <h2>Identity Documents</h2>
                  </div>
                  
                </div>
                <div class="ln_solid" style="margin-top: 0;"></div>
                <form id="identity_form" method="post" action="{% url 'racers:add_identity' racer.id %}" data-parsley-validate class="form-horizontal form-label-left"  enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-group">
                  <label class="control-label col-md-2 col-sm-2 col-xs-12" for="first-name">Document
                  </label>
                  <div class="col-md-2 col-sm-2 col-xs-12">
                    <input type="text" id="id_type" name="identitytype" class="form-control col-md-7 col-xs-12">
                  </div>
                  <label class="control-label col-md-1 col-sm-1 col-xs-12" for="first-name">Expiry</label>
                  <div class="col-md-3 col-sm-3 col-xs-12">
                    <input type="text" id="id_identexpiry" name="expiry_date" class="form-control col-md-7 col-xs-12">
                  </div>
                  <div class="col-md-1 col-sm-1 col-xs-12">
                    <button id="btn_id_id" style="" type="button" class="btn btn-danger btn-round">
                      <span class="glyphicon glyphicon-cloud-upload"></span> Upload Scan
                    </button>                 
                  <input id="id_identity" type="file" name="identity" multiple data-url="" data-form-data='{"csrfmiddlewaretoken": "{{ csrf_token }}"}' enctype="multipart/form-data" style="display: none;">
                  </div>
                </div>

              </form>
              <div class="ln_solid"></div>
                  <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
                <thead>
                  <tr>
                    <th>License Type</th>
                    <th>Expiry Date</th>
                    <th>Expires In</th>
                    <th>Download</th>
                  </tr>
                </thead>


                <tbody>
                  {% for lic in racer_identities %}
                  <tr>
                    <td align="center">{{ lic.identity_type.name }}</td>
                    <td align="center">{{ lic.expires|date:"d/m/Y" }}</td>
                    <td align="center">{{ lic.expiry_dt|naturaltime}}</td>
                    <td align="center"><a href="{{ lic.file.url }}" target="_blank"><i class="fa fa-cloud-download"></i> Download</a></td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modal-progress" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Uploading...</h4>
      </div>
      <div class="modal-body">
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: 0%;">0%</div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block javascripts %}
  {{ block.super}}
  <!-- Chart.js -->
  <script src="/static/vendors/Chart.js/dist/Chart.min.js"></script>
  <!-- gauge.js -->
  <script src="/static/vendors/gauge.js/dist/gauge.min.js"></script>
  <!-- Skycons -->
  <script src="/static/vendors/skycons/skycons.js"></script>
  <!-- Flot -->
  <script src="/static/vendors/Flot/jquery.flot.js"></script>
  <script src="/static/vendors/Flot/jquery.flot.pie.js"></script>
  <script src="/static/vendors/Flot/jquery.flot.time.js"></script>
  <script src="/static/vendors/Flot/jquery.flot.stack.js"></script>
  <script src="/static/vendors/Flot/jquery.flot.resize.js"></script>
  <!-- Flot plugins -->
  <script src="/static/vendors/flot.orderbars/js/jquery.flot.orderBars.js"></script>
  <script src="/static/vendors/flot-spline/js/jquery.flot.spline.min.js"></script>
  <script src="/static/vendors/flot.curvedlines/curvedLines.js"></script>
  <!-- DateJS -->
  <script src="/static/vendors/DateJS/build/date.js"></script>
  <!-- JQVMap -->
  <script src="/static/vendors/jqvmap/dist/jquery.vmap.js"></script>
  <script src="/static/vendors/jqvmap/dist/maps/jquery.vmap.world.js"></script>
  <script src="/static/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js"></script>
  <!-- Data Tables -->
  <script src="/static/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
  <script src="/static/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/buttons.flash.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
  <script src="/static/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
  <script src="/static/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
  <script src="/static/vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
  <script src="/static/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
  <script src="/static/vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>
  <script src="/static/vendors/jszip/dist/jszip.min.js"></script>
  <script src="/static/vendors/pdfmake/build/pdfmake.min.js"></script>
  <script src="/static/vendors/pdfmake/build/vfs_fonts.js"></script>
  <script src="/static/vendors/raphael/raphael.min.js"></script>
  <script src="/static/vendors/morris.js/morris.min.js"></script>
  <!-- File Upload -->
  <script src="/static/vendors/jquery-file-upload/js/vendor/jquery.ui.widget.js"></script>
  <script src="/static/vendors/jquery-file-upload/js/jquery.iframe-transport.js"></script>
  <script src="/static/vendors/jquery-file-upload/js/jquery.fileupload.js"></script>
  <script src="/static/vendors/intl-tel-input/build/js/intlTelInput.js"></script>

  <script>

  function init_countries() {

    var countries = { {% for country in countries %}{{ country.code }} : "{{country.name }} [{{ country.code }}]", {% endfor %}};

    var countriesArray = $.map(countries, function(value, key) {
        return {
            value: value,
            data: key
        };
    });

    // initialize autocomplete with custom appendTo
    {% if racer.country %}
    $('#id_nationality').autocomplete({
        lookup: countriesArray
    }).val('{{ racer.country.name }} [{{ racer.country.code }}]').data('autocomplete');
    {% else %}
    $('#id_nationality').autocomplete({
        lookup: countriesArray
    })
    {% endif %}

  };


  function init_event() {

    var countries = { {% for country in countries %}{{ country.code }} : "{{country.name }} [{{ country.code }}]", {% endfor %}};

    var countriesArray = $.map(countries, function(value, key) {
        return {
            value: value,
            data: key
        };
    });

    // initialize autocomplete with custom appendTo

    $('#id_event_location').autocomplete({
        lookup: countriesArray
    })


  };

   function init_license() {

    var countries = { {% for lic in licenses %}{{ lic.id }} : "{{lic.name }} [{{ lic.id }}]", {% endfor %}};

    var countriesArray = $.map(countries, function(value, key) {
        return {
            value: value,
            data: key
        };
    });

    // initialize autocomplete with custom appendTo

    $('#id_licensetype').autocomplete({
        lookup: countriesArray
    })


  };

  function init_ident() {

    var countries = { {% for lic in identities %}{{ lic.id }} : "{{lic.name }} [{{ lic.id }}]", {% endfor %}};

    var countriesArray = $.map(countries, function(value, key) {
        return {
            value: value,
            data: key
        };
    });

    // initialize autocomplete with custom appendTo

    $('#id_type').autocomplete({
        lookup: countriesArray
    })


  };

    function init_home() {

    var countries = { {% for country in countries %}{{ country.code }} : "{{country.name }} [{{ country.code }}]", {% endfor %}};

    var countriesArray = $.map(countries, function(value, key) {
        return {
            value: value,
            data: key
        };
    });

    // initialize autocomplete with custom appendTo

    {% if racer.address_country %}
    $('#id_home_country').autocomplete({
        lookup: countriesArray
    }).val('{{ racer.address_country.name }} [{{ racer.address_country.code }}]').data('autocomplete');
    {% else %}
    $('#id_current_boat').autocomplete({
        lookup: countriesArray
    })
    {% endif %}

  };

  function textAreaAdjust(o) {
  o.style.height = "1px";
  o.style.height = (25+o.scrollHeight)+"px";
}

  $(document).ready(function() {
  init_countries();
  init_home();
  init_event();
  init_license();
  init_ident();

  $("#id_build_date").val("{{ racer.date_of_birth|date:'d/m/Y' }}");
  $("#message").val("{{ racer.profile_text }}");
  $("#message").height(100);
  $("#message").keyup();
  $('#myTab a[href="#tab_content1"]').tab('show')

  $('#btn_id').click(function(event){
      $('#id_license').click();
    });

  $('#id_license').on('change', function(event){
      $('#btn_id').html('<i class="fa fa-check"></i> File Uploaded');
      $('#btn_id').removeClass('btn-danger');
      $('#btn_id').addClass('btn-success');
      $('#license_form').submit();
  })
  $('#btn_id_id').click(function(event){
      $('#id_identity').click();
    });

  $('#id_identity').on('change', function(event){
      $('#btn_id_id').html('<i class="fa fa-check"></i> File Uploaded');
      $('#btn_id_id').removeClass('btn-danger');
      $('#btn_id_id').addClass('btn-success');
      $('#identity_form').submit();
  })

   $('#id_identexpiry').daterangepicker({
        singleDatePicker: true,
        singleClasses: "picker_3",
        gotoCurrent: true,
        locale: {
            format: 'DD/MM/YYYY',
        },
        defaultDate: +7,
        dateFormat: 'DD/MM/YYYY',
        minDate: new Date(),
    }, function(start, end, label) {
        console.log(start.toISOString(), end.toISOString(), label);
    });
  });

  </script>

<script>
    var input = document.querySelector("#id_phonenumber_in");

    window.intlTelInput(input, {
       allowDropdown: true,
      // autoHideDialCode: false,
      // autoPlaceholder: "off",
      // dropdownContainer: document.body,
      // excludeCountries: ["us"],
      // formatOnDisplay: false,
      hiddenInput: "phonenumber",
      initialCountry: "gb",
      // localizedCountries: { 'de': 'Deutschland' },
      // nationalMode: false,
      // onlyCountries: ['us', 'gb', 'ch', 'ca', 'do'],
      // placeholderNumberType: "MOBILE",
      preferredCountries: ['gb', 'hk'],
      // separateDialCode: true,
      utilsScript: "/static/vendors/intl-tel-input/build/js/utils.js",
    }){% if racer.telephone_number %}.setNumber("{{ racer.telephone_number }}"){% endif %};
    

  </script>


{% endblock javascripts %}
